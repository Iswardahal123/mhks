<div style="padding: 10px;">
  <h2>Dashboard</h2>
  <div id="loading">Loading names...</div>
  <div style="overflow-x: auto;">
    <table id="membersTable" style="width: 100%; border-collapse: collapse; display: none;">
      <thead>
        <tr style="background-color: #000; color: white;">
          <th style="padding: 10px;">Name</th>
          <th style="padding: 10px;">Action</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<div id="bottomNavContainer"></div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCyibssZJsYwzI_2VXwC98iUGix2IkFczM",
    authDomain: "iswar-121d6.firebaseapp.com",
    projectId: "iswar-121d6",
    storageBucket: "iswar-121d6.appspot.com",
    messagingSenderId: "696246777134",
    appId: "1:696246777134:web:065951d401a56d8c7d76bf",
    measurementId: "G-HG807RGEGJ"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  async function loadUsers() {
    const table = document.getElementById("membersTable");
    const tbody = table.querySelector("tbody");
    const loading = document.getElementById("loading");

    try {
      const querySnapshot = await getDocs(collection(db, "users"));
      if (querySnapshot.empty) {
        loading.innerText = "No users found.";
        return;
      }

      querySnapshot.forEach(doc => {
        const name = doc.id;
        const row = document.createElement("tr");
        row.innerHTML = `
          <td style="padding: 8px;">${name}</td>
          <td style="padding: 8px;">
            <button style="padding: 5px 10px; background: blue; color: white; border: none;">View</button>
          </td>
        `;
        tbody.appendChild(row);
      });

      loading.style.display = "none";
      table.style.display = "table";
    } catch (error) {
      loading.innerText = "Failed to load users.";
      console.error(error);
    }
  }

  loadUsers();

  // Include bottom nav
  fetch('bottomnav.html')
    .then(res => res.text())
    .then(html => {
      document.getElementById("bottomNavContainer").innerHTML = html;
    });
</script>
